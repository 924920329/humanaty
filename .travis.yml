os: osx
osx_image: xcode10.2
language: generic
before_script:
- brew update
- brew install --HEAD usbmuxd
- brew unlink usbmuxd
- brew link usbmuxd
- brew unlink python@2
- brew link --overwrite python
- brew install --HEAD libimobiledevice
- brew install ideviceinstaller
- brew install ios-deploy
- git clone https://github.com/flutter/flutter.git -b beta --depth 1
script:
- flutter/bin/flutter doctor -v
- flutter/bin/flutter build ios --debug --no-codesign
cache:
  directories:
  - "$HOME/.pub-cache"
before_deploy:
- pushd build/ios/iphoneos
- mkdir Payload
- cd Payload
- ln -s ../Runner.app
- cd ..
- zip -r app.ipa Payload
- popd
deploy:
  provider: releases
  api_key:
    secure: wGJrm9c7xP80DIpCcaIRGACmL46hS5YZt88j/sUllDyM8ANa0M8tXM86h/lwASaUOPBizs4iMgsBmpOyroKUJYgkZKZit8bFiprQH8JO88KfmStU/2oMl9ULwywRL2xLN5xFXYEZ/kw3B+n3SWZdJ7UVZtfFXFTfoL+FPmexauAxU2IISxB3VXAL7QqTT4lwuoyAeWtZohZ6GBXGm+YIqYGEAtXWOd44q1DY3KbNzUGomk5n2D+XzAUQtWGQhpbBNEFCBDNmmPp6a/jQY2ev9Kc50LQvYGWO3N4qtvbcaeSlKV0oFoxNObHXD96LIMML59BJ0ndPvyrDKruRCUa+SmtN9YsVRsKXx4g+b8b2F8xsfGhI8/goOk29qimnVsGJaednX9pXQIxanMXUVGD3IzgeFxLHhonVTnd34FQKaQGPuMVWE62WXkR19vGjTT8hZ7LueI20CRepqZ2nyvEaAUj6dHpcvSe+IisxCilSGIxee3SPq0UP7XMrhIPMeUC6WH6ELYz7CDbWpDeK9FOoi760ZXdW43B5BKJuAxf9+3m37miuIZ2pPfAOrUDSTY/WTfru63ilZcUyw34aOzIdn4e+ft7u3l9VbdWyq9GUvA2dmqAl68uycjy766hqv/fQ2TLwVEmLPp0w5fnKRSG4ZMPQprefX/Tt6kb1tMX6GDc=
  file: build/ios/iphoneos/app.ipa
  skip_cleanup: true
